<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="description" content="$1">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="stylesheet" type="text/css" href="form.css">
    <link rel="stylesheet" type="text/css" href="font-awesome-4.7.0\css\font-awesome.min.css">
    <link rel="icon" href="images\corridor-icon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jexcel/2.0.2/css/jquery.jexcel.css" type="text/css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <link rel="stylesheet" href="https://jexcel.net/v3/jexcel.css" type="text/css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jexcel/2.1.0/css/jquery.jcalendar.css" type="text/css" />

    <script src="https://jexcel.net/v2/jexcel.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.8.3/jquery.csv.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jexcel/2.0.0/js/jquery.jexcel.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jexcel/2.0.2/js/jquery.jcalendar.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jexcel/2.1.0/js/jquery.jcalendar.js"></script>



    <script src="corimport.js" type="text/javascript"></script>

    <title>CorImport Web Tool</title>

  </head>
  <body>

  <div class="style">
    <form>
      <div class="menu-container" onclick="openHelpMenu(this)">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
          <div id="help-menu-contents" class="dropdown-content">
            <a href="https://support.corridor.aero/hc/en-us/sections/115000828514-CorImport">CorImport How-To</a>
            <a href="https://support.corridor.aero/hc/en-us/categories/115001230327-FAQ">Corridor FAQ</a>
            <a href="#">Launch corimport.exe</a>
          </div>
      </div>
      <a href="https://www.corridor.aero/"><img src="images\CORRIDOR-CAMP-Systems-White-copy.png" alt="CORRIDOR"></a><br/>
      <div id="sub-div">
        <div id="header-container">
          <h1 id="data-set-name"></h1><br/>
          <p id="data-file-name"></p><br/><br/>
          <hr id="dataset-hr"/><br/>
        </div>
        <div id="spreadsheet"></div><br/>
        <div class="button-container">
          <button type="button" id="btnDownloadCSV" class="button-style"><i class="fa fa-download"></i>    Download CSV</button><br/>
          <button type="button" id="btnSendToSupport" class="button-style"><i class="far fa-envelope"></i>   Send to CORRIDOR Support</button><br/>
          <button type="button" id="btnRestart" class="button-style"><i class="fa fa-repeat" aria-hidden="true"></i>    Restart</button>
        </div>
      </div>
    </form>
  </div>

  <div id="email-modal">
    <div id="email-modal-content">
      <span class="information"><i id="email-info" class="fas fa-info-circle"></i></span>
      <span id="modal-close" class="close"><i class="far fa-times-circle"></i></span><br/>
      <h2>Send File to Corridor Support</h2>
      <p>Subject: <input type="text" id="email-subject" class="modal-h2"></p>
      <textarea rows="10" placeholder="Include a message..."></textarea><br>
      <p>Attach the error log: </br><input type="file" name="fileToUpload" accept=".txt" required/></p>
      </hr>
      <div class="index-button-container">
        <button id="btnEmailSupport" class="button-style"><i class="fas fa-paper-plane"></i>   Send</button>
      </div>
    </div>
  </div>

<script type="text/javascript">
var dataSetName = document.getElementById('data-set-name');
var dataFileName = document.getElementById('data-file-name');
var data = localStorage.getItem("dataFileName");
var emailModal = document.getElementById('email-modal');
var dataSetNameText = localStorage.getItem('dataSetName');
var dateFormat = localStorage.getItem('ss-DateFormat');
var decimalSep = localStorage.getItem('ss-DecimalSepFormat');
var thousandSep = localStorage.getItem('ss-ThousandSepFormat');

//Display help menu
function openHelpMenu(x) {
  var helpMenuContents = document.getElementById("help-menu-contents");

  if (helpMenuContents.style.display !== "block") {
    helpMenuContents.style.display = "block";
  } else {
    helpMenuContents.style.display = "none";
  }

  x.classList.toggle("change");
}

if (localStorage.getItem('dataSetName') == null) {
  dataSetName.innerHTML = "CorImport Web Tool";
  alert('Please return the the home page and select a Data Set and a Data File to format.');
} else {
  dataSetName.innerHTML = localStorage.getItem('dataSetName') + " Import";
}

if (data == null) {
  dataFileName.innerHTML = "**No file has been selected**";
  dataFileName.style.color = '#FF0000';
} else {
  var trimFileName = localStorage.getItem('fileURL').slice(12);
  dataFileName.innerHTML = "The name of this file is " + trimFileName;
}

//'DD-Mon-YYYY currently not working, so setting fields to text type if that date format is selected'
var calendarType;
if (dateFormat != "DD-Mon-YYYY") {
  calendarType = 'calendar';
  dateFormat
} else {
    calendarType = 'text';
}

//Spreadsheet entry
switch(dataSetNameText) {
  case 'Add Account Numbers':
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  tableHeight: '430px',
  colWidths: [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200],
  columns: [
            { type: 'text' },
            { type: 'dropdown', source:[{id:1,name:'Accounts payable'},
                                           {id:2,name:'Accounts receivable'},
                                           {id:3,name:'Cash'},
                                           {id:4,name:'Cost of sales'},
                                           {id:5,name:'Current liabilities'},
                                           {id:6,name:'Expenses'},
                                           {id:7,name:'Inventory'},
                                           {id:8,name:'Purchases'},
                                           {id:9,name:'Sales revenue'},
                                           {id:10,name:'Work in process'}
                                         ]},
            { type: 'text' },
        ]
  });
  break;
  case 'Add Aircraft':
  //Aircrafts
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat }
            },
            { type: calendarType,
               options: { format: dateFormat }
            },
            { type: 'numeric', mask:'###.##,00', decimal:',' },
            { type: 'numeric', mask:'###.##,00', decimal:',' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat }
            },
        ]
  });
  break;
  case 'Canned Squawk Applicability':
  //CSqwk Applicability
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'numeric' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
        ]
  });
  break;
  case 'Canned Squawk Estimate Adjustment':
  //CSqwk Est Adj
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'numeric' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
        ]
  });
  break;
  case 'Canned Squawk Estimated Labor':
  //CSqwk Est Labor
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'numeric' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'numeric' },
            { type: 'numeric' },
        ]
  });
  break;
  case 'Canned Squawk Files':
  //CSqwk Files
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'numeric' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
        ]
  });
  break;
  case 'Canned Squawk Part':
  //CSqwk Parts
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'numeric' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'checkbox' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'text' },
        ]
  });
  break;
  case 'Canned Squawk Planning':
  //CSqwk Planning
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'numeric' },
            { type: 'text' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
        ]
  });
  break;
  case 'Canned Squawk':
  //CSqwk
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
        ]
  });
  break;
  case 'Add Company Addresses':
  //Company Address
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
        ]
  });
  break;
  case 'Add Company Phone':
  //Company Phone
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
        ]
  });
  break;
  case 'Add Company Profile':
  //Company Profile
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'numeric' },
            { type: calendarType,
               options: { format: dateFormat }
            },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat }
            },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'text' },
        ]
  });
  break;
  case 'Add Contact Address':
  //Contact Addresses
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
        ]
  });
  break;
  case 'Add Contact Phone':
  //Contact Phones
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
        ]
  });
  break;
  case 'Add Contact Profile':
  //Contact Profiles
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat }
            },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat }
            },
            { type: 'text' },
            { type: 'text' },
        ]
  });
  break;
  case 'Part Masters':
  //Part Masters
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'numeric' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'numeric' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'numeric' },
        ]
  });
  break;
  case 'Add Inventory Lots':
  //Inventory Lots
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: calendarType,
               options: { format: dateFormat }
            },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: calendarType,
               options: { format: dateFormat }
            },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: calendarType,
               options: { format: dateFormat }
            },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat }
            },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat }
            },
            { type: calendarType,
               options: { format: dateFormat }
            },
            { type: calendarType,
               options: { format: dateFormat }
            },
        ]
  });
  break;
  case 'Part Discount Codes':
  //Part Discount Codes
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'numeric' },
        ]
  });
  break;
  case 'Part Pricing':
  //Part Pricing
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
        ]
  });
  break;
  case 'Warehouse Min & Max':
  //Warehouse Min/Max
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'numeric' },
        ]
  });
  break;
  case 'Tool Master':
  //Tool Master
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
          ]
  });
  break;
  case 'Tool Master Calibration':
  //Tool Master Cal
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'numeric' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'text' },
          ]
  });
  break;
  case 'Tools':
  //Tool IDs
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'numeric' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat }
            },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat }
            },
        ]
  });
  break;
  case 'Work Pak Applicability':
  //Work Pak Applicability
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'numeric' },
            { type: 'text' },
            { type: 'text' },
        ]
  });
  break;
  case 'Work Pak Detail':
  //Work Pak Detail
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'numeric' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'checkbox' },
            { type: 'text' },
        ]
  });
  break;
  case 'Work Pak Estimate Adjustment':
  //Work Pak Est Adj
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
        ]
  });
  break;
  case 'Work Pak Estimated Labor':
  //Work Pak Est Labor
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'numeric' },
            { type: 'numeric' },
        ]
  });
  break;
  case 'Work Pak Part':
  //Work Pak Parts
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'checkbox' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'checkbox' },
        ]
  });
  break;
  case 'Work Pak Planning':
  //Work Pak Planning
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'text' },
            { type: 'text' },
            { type: 'numeric' },
            { type: 'numeric' },
            { type: 'numeric' },
        ]
  });
  break;
  case 'Work Pak':
  //Work Paks
  $('#spreadsheet').jexcel({
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableOverflow: true,
  lazyLoading:true,
  loadingSpin:true,
  tableHeight: '430px',
  defaultColWidth: 200,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'text' },

        ]
  });
  break;
}

//Download CSV button function, thn return to index.html
$('#btnDownloadCSV').on('click', function () {
   $('#spreadsheet').jexcel('download');
 });

//Retrun to index.html
 $('#btnRestart').on('click', function () {
   location.href = 'index.html';
 });

// When the user clicks the button, open the email modal and populate the subject line
 $("#btnSendToSupport").click(function() {
   $("#email-modal").fadeIn('fast');
   $("#email-subject").val(localStorage.getItem('dataSetName') + ' CorImport Issue');
 });

 $("#email-info").click(function() {
   alert("This window will allow you to send the data file for review to Corridor Support. Please include your name, aswell as the name of the Company that you are loading the data for in the message of this email.");
 });

 $('#btnEmailSupport').click(function() {

   $("#email-modal").fadeOut('fast');
 });

 $("#modal-close").click(function() {
   $("#email-modal").fadeOut('fast');
 });

// When the user clicks anywhere outside of the modal, close it
 $(window).click(function(event) {
   if (event.target == emailModal) {
     $("#email-modal").fadeOut('fast');
   }
 });
 </script>

  </body>
</html>
