<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="description" content="$1">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="stylesheet" type="text/css" href="form.css">
    <link rel="stylesheet" type="text/css" href="font-awesome-4.7.0\css\font-awesome.min.css">
    <link rel="icon" href="images\corridor-icon.png">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <link rel="stylesheet" href="https://jexcel.net/v3/jexcel.css" type="text/css"/>
    <link rel="stylesheet" href="https://jexcel.net/v3/japp.css" type="text/css"/>
    <link rel="stylesheet" type="text/css" href="material-icons.css"/>

    <script src="https://jexcel.net/v3/jexcel.js"></script>
    <script src="https://jexcel.net/v3/japp.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.8.3/jquery.csv.min.js"></script>

    <script src="corimport.js" type="text/javascript"></script>

    <title>CorImport Web Tool</title>

  </head>
  <body>

  <div class="style">
    <form>
      <div class="menu-container" onclick="openHelpMenu(this)">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
          <div id="help-menu-contents" class="dropdown-content">
            <a href="https://support.corridor.aero/hc/en-us/sections/115000828514-CorImport">CorImport How-To</a>
            <a href="https://support.corridor.aero/hc/en-us/categories/115001230327-FAQ">Corridor FAQ</a>
            <!-- <a href="#">Launch corimport.exe</a> -->
          </div>
      </div>
      <a href="https://www.corridor.aero/"><img src="images\CORRIDOR-CAMP-Systems-White-copy.png" alt="CORRIDOR"></a><br/>
      <div id="sub-div">
        <div id="header-container">
          <h1 id="data-set-name"></h1><br/>
          <p id="data-file-name"></p><br/>
          <hr id="dataset-hr"/><br/>
        </div>
        <div></div>
        <div id="spreadsheet"></div><br/>
        <div class="button-container">
          <button type="button" id="btnSendToSupport" class="button-style"><i class="fas fa-envelope"></i>  Send to CORRIDOR Support</button><br/>
          <button type="button" id="btnRestart" class="button-style"><i class="fa fa-repeat" aria-hidden="true"></i>    Restart</button>
        </div>
      </div>
    </form>
  </div>

  <div id="email-modal">
    <div id="email-modal-content">
      <span class="information"><i id="email-info" class="fas fa-info-circle"></i></span>
      <span id="modal-close" class="close"><i class="far fa-times-circle"></i></span><br/>
      <h2>Send File to Corridor Support</h2>
      <p>Subject: <input type="text" id="email-subject" class="modal-h2"></p>
      <textarea rows="10" placeholder="Include a message..."></textarea><br>
      <p>Attach the data file: </br><input type="file" id="email-data-file" name="fileToUpload" accept=".csv" required/></p>
      <p>Attach the error log: </br><input type="file" name="fileToUpload" accept=".txt" required/></p>
      </hr>
      <div class="email-button-container">
        <button id="btnEmailSupport" class="button-style"><i class="fas fa-paper-plane"></i>   Send</button>
      </div>
    </div>
  </div>

<script type="text/javascript">
var dataSetName = document.getElementById('data-set-name');
var dataFileName = document.getElementById('data-file-name');
var data = localStorage.getItem("dataFileName");
var btnSendToSupport = document.getElementById("btnSendToSupport");
var emailModal = document.getElementById('email-modal');
var dataSetNameText = localStorage.getItem('dataSetName');
var dateFormat = localStorage.getItem('ss-DateFormat');
var decimalSep = localStorage.getItem('ss-DecimalSepFormat');
var td = document.getElementsByTagName("td");

//Display help menu
function openHelpMenu(x) {
  var helpMenuContents = document.getElementById("help-menu-contents");

  if (helpMenuContents.style.display !== "block") {
    helpMenuContents.style.display = "block";
  } else {
    helpMenuContents.style.display = "none";
  }
  x.classList.toggle("change");
}

if (localStorage.getItem('dataSetName') == null) {
  dataSetName.innerHTML = "CorImport Web Tool";
  btnSendToSupport.style.display = 'none';
  alert('Please return the the home page and select a Data Set and a Data File to format.');
} else {
  dataSetName.innerHTML = localStorage.getItem('dataSetName') + " Import";
  btnSendToSupport.style.display = 'block';
}

if (data == null) {
  dataFileName.innerHTML = "**No file has been selected**";
  dataFileName.style.color = '#FFFF66';
} else {
  var trimFileName = localStorage.getItem('fileURL').slice(12);
  dataFileName.innerHTML = "The name of this file is " + trimFileName;
}

//'DD-Mon-YYYY' and 'YYYY/MM/DD' currently not working, so setting fields to text type if those date formats are selected
var calendarType;
if (dateFormat !== "DD-Mon-YYYY" || dateFormat !== "YYYY/MM/DD") {
  calendarType = 'calendar';
  dateFormat;
} else {
    calendarType = 'text';
}

//Setting the numeric field masks
var numMask;
if (decimalSep == '.') {
  numMask = '#0.0#';
} else {
  numMask = '#0,0#';
}

//Insert '#NULL' for empty cells
function insertNull() {
  if (document.querySelectorAll('tbody > .draggable > td') == "") {
  }
}

// var booleanVal = {if (cell.innerHTML != "") {
//     if (cell.innerHTML != 1 || if cell.innerHTML != 0) {
//       cell.innerHTML = 1;
//     }
//   } else {
//     return;
//   }

//Spreadsheet entry
switch(dataSetNameText) {
  case 'Add Account Numbers':

  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'numeric', mask: '0', /*editor: booleanVal*/ },
            { type: 'text' },
            { type: 'dropdown', source:[{id:1,name:'Accounts payable'},
                                        {id:2,name:'Accounts receivable'},
                                        {id:3,name:'Cash'},
                                        {id:4,name:'Cost of sales'},
                                        {id:5,name:'Current liabilities'},
                                        {id:6,name:'Expenses'},
                                        {id:7,name:'Inventory'},
                                        {id:8,name:'Purchases'},
                                        {id:9,name:'Sales revenue'},
                                        {id:10,name:'Work in process'}
                                      ], autocomplete:true},
            { type: 'text' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'add', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {
            if (td.innerText == "") {
              td.innerText = '#NULL';
            }
                                                            }
                                                          },
          ],
        //Make cells yellow if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
          var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
          var numCols = headerLabels.length;

          var td = document.querySelectorAll("td");
          var numCells = td.length;
          var tdCheckbox = document.querySelector("input[type=checkbox]");
          var crsCell = document.querySelectorAll('table.jexcel > tbody > tr > td');
          var jexcelRow = document.querySelectorAll('td.jexcel_row');




            // for (let j = 0; j < numCells; j++) {
            //   var tdCheckboxValue = tdCheckbox[j];
            //   if (tdCheckbox.checked) {
            //     cell.style.backgroundColor = '#FFFFFF';
            //   } else {
            //     cell.style.backgroundColor = '#FFFF00';
            //   }
            // }

            // for (let i = 0; i < numCols; i++) {
                // if (spreadsheet.getHeaders[i] == "Account Number") {
                  if (cell.innerText == "" ) {
                      cell.style.backgroundColor = '#FFFF00';
                  } else {
                      cell.style.backgroundColor = '#FFFFFF';
                  }
              // }
          // }

          for (let k = 0; k < jexcelRow.length; k++) {
            if (cell.style.backgroundColor == '#FFFF00') {
              jexcelRow[k].style.backgroundColor = '#FFFF00';
            } else {
              jexcelRow[k].style.backgroundColor = '#F3F3F3';
            }
          }

        }
      });
  break;
  case 'Add Aircraft':
  //Aircrafts
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Canned Squawk Applicability':
  //CSqwk Applicability
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Canned Squawk Estimate Adjustment':
  //CSqwk Est Adj
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Canned Squawk Estimated Labor':
  //CSqwk Est Labor
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Canned Squawk Files':
  //CSqwk Files
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Canned Squawk Part':
  //CSqwk Parts
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'checkbox' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Canned Squawk Planning':
  //CSqwk Planning
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Canned Squawk':
  //CSqwk
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'checkbox' },
            { type: 'checkbox' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Add Company Addresses':
  //Company Address
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Add Company Phone':
  //Company Phone
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Add Company Profile':
  //Company Profile
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'text' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Add Contact Address':
  //Contact Addresses
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Add Contact Phone':
  //Contact Phones
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Add Contact Profile':
  //Contact Profiles
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            { type: 'text' },
            { type: 'text' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Part Masters':
  //Part Masters
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Add Inventory Lots':
  //Inventory Lots
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Part Discount Codes':
  //Part Discount Codes
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
        ]
  });
  break;
  case 'Part Pricing':
  //Part Pricing
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Warehouse Min & Max':
  //Warehouse Min/Max
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Tool Master':
  //Tool Master
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
          ],
          toolbar:[
            { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
            { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
            { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
            { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
      ],
          //Make cells red if they are missing data
          updateTable:function(instance, cell, col, row, val, label, cellName) {
              //Checks cells that are empty (sends warning with red text)
              if (cell.innerText == "") {
                cell.style.backgroundColor = '#ff7676';
              } else {
              cell.style.backgroundColor = '#ffffff';
            }

          }
  });
  break;
  case 'Tool Master Calibration':
  //Tool Master Cal
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
          ],
          toolbar:[
            { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
            { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
            { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
            { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
      ],
          //Make cells red if they are missing data
          updateTable:function(instance, cell, col, row, val, label, cellName) {
              //Checks cells that are empty (sends warning with red text)
              if (cell.innerText == "") {
                cell.style.backgroundColor = '#ff7676';
              } else {
              cell.style.backgroundColor = '#ffffff';
            }

          }
  });
  break;
  case 'Tools':
  //Tool IDs
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Work Pak Applicability':
  //Work Pak Applicability
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            { type: 'text' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Work Pak Detail':
  //Work Pak Detail
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'checkbox' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'checkbox' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'checkbox' },
            { type: 'text' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Work Pak Estimate Adjustment':
  //Work Pak Est Adj
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#FFFF66';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Work Pak Estimated Labor':
  //Work Pak Est Labor
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            { type: 'checkbox' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Work Pak Part':
  //Work Pak Parts
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'checkbox' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'checkbox' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Work Pak Planning':
  //Work Pak Planning
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == "") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
  case 'Work Pak':
  //Work Paks
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  // Get the first of the CSV file and consider the headers
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading:true,
  loadingSpin:true,
  defaultColWidth: 150,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'checkbox' },
            { type: 'text' },

        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content:'#NULL', onclick:function () { spreadsheet.setValue(['i'],['#NULL']); } },
    ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            if (cell.innerText == null || cell.innerText == "0") {
              cell.style.backgroundColor = '#ff7676';
            } else {
            cell.style.backgroundColor = '#ffffff';
          }

        }
  });
  break;
}

function openFile(event) {
  var input = event.target;
  var errorFileReader = new FileReader();

  errorFileReader.onload = function() {
  var dataURL = errorFileReader.result;
  var output = localStorage.setItem("errorFilePath", dataURL);
};
errorFileReader.readAsDataURL(input.files[0]);

};

//Return to index.html
 $('#btnRestart').on('click', function () {
   location.href = 'index.html';
 });

// When the user clicks the button, open the email modal and populate the subject line
 $("#btnSendToSupport").click(function() {
   $("#spreadsheet").css("display", "none");
   $("#btnSendToSupport").css("display", "none");
   $("#btnRestart").css("display", "none");
   $("#email-modal").fadeIn('fast');
   $("#email-subject").val(localStorage.getItem('dataSetName') + ' CorImport Issue');
 });

 $("#email-info").click(function() {
   alert("This window will allow you to send the data file for review to Corridor Support. Please include your name, aswell as the name of the Company that you are loading the data for in the message of this email.");
 });

 $('#btnEmailSupport').click(function() {
   $("#email-modal").fadeOut('fast');
   $("#spreadsheet").css("display", "block");
   $("#btnSendToSupport").css("display", "block");
   $("#btnRestart").css("display", "block");
 });

 $("#modal-close").click(function() {
   $("#email-modal").fadeOut('fast');
   $("#spreadsheet").css("display", "block");
   $("#btnSendToSupport").css("display", "block");
   $("#btnRestart").css("display", "block");
 });

// When the user clicks anywhere outside of the modal, close it
 $(window).click(function(event) {
   if (event.target == emailModal) {
     $("#email-modal").fadeOut('fast');
     $("#spreadsheet").css("display", "block");
     $("#btnSendToSupport").css("display", "block");
     $("#btnRestart").css("display", "block");
   }
 });
 </script>

  </body>
</html>
