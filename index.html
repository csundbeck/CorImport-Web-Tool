
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="description" content="$1">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" type="text/css" href="style.css">
  <link rel="stylesheet" type="text/css" href="form.css">
  <link href="https://unpkg.com/tabulator-tables@4.2.0/dist/css/tabulator.min.css" rel="stylesheet">
  <link rel="icon" href="images\corridor-icon.png">

  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.5/xlsx.full.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.5/jszip.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/handsontable-pro@6.2.2/dist/handsontable.full.min.js"></script>

  <title>CorImport Web Tool</title>

</head>
<body>

  <div class="style">

    <form action="dataset.html">
      <a id="help" href="https://support.corridor.aero/hc/en-us/restricted?return_to=https%3A%2F%2Fsupport.corridor.aero%2Fhc%2Fen-us">Help</a>
      <a href="https://www.corridor.aero/"><img src="images\CORRIDOR-CAMP-Systems-White-copy.png" alt="CORRIDOR"></a><br/>
      <h1>Welcome to the CorImport Web Tool!</h1><br/>
      <hr/>
      <label id="name">Data Set</label><br/>
      <select id="dataSetDropDown" onchange="dataSetNameSave()">
        <option disabled selected>Select a data set...</option>
        <optgroup label="Accounting">
          <option value="Add Account Numbers">Add Account Numbers</option>
        </optgroup>
        <optgroup label="Aircraft">
          <option value="Add Aircraft">Add Aircraft</option>
        </optgroup>
        <optgroup label="Add/Update Canned Squawk">
          <option value="Canned Squawk Applicability">Canned Squawk Applicability</option>
          <option value="Canned Squawk Estimate Adjustment">Canned Squawk Estimate Adjustment</option>
          <option value="Canned Squawk Estimated Labor">Canned Squawk Estimated Labor</option>
          <option value="Canned Squawk Files">Canned Squawk Files</option>
          <option value="Canned Squawk Part">Canned Squawk Part</option>
          <option value="Canned Squawk Planning">Canned Squawk Planning</option>
          <option value="Canned Squawk">Canned Squawk</option>
        </optgroup>
        <optgroup label="Company Database">
          <option value="Add Company Addresses">Add Company Address</option>
          <option value="Add Company Phone">Add Company Phone</option>
          <option value="Add Company Profile">Add Company Profile</option>
        </optgroup>
        <optgroup label="Contact">
          <option value="Add Contact Address">Add Contact Address</option>
          <option value="Add Contact Phone">Add Contact Phone</option>
          <option value="Add Contact Profile">Add Contact Profile</option>
        </optgroup>
        <optgroup label="Add/Update Inventory">
          <option value="Part Masters">Part Masters</option>
          <option value="Add Inventory Lots">Add Inventory Lots</option>
          <option value="Part Discount Codes">Part Discount Codes</option>
          <option value="Part Pricing">Part Pricing</option>
          <option value="Warehouse Min & Max">Warehouse Min & Max</option>
        </optgroup>
        <optgroup label="Add/Update Tool Crib">
          <option value="Tool Master">Tool Master</option>
          <option value="Tool Master Calibration">Add/Update Tool Master Calibration</option>
          <option value="Tools">Tools</option>
        </optgroup>
        <optgroup label="Add/Update Work Paks">
          <option value="Work Pak Applicability">Work Pak Applicability</option>
          <option value="Work Pak Detail">Work Pak Detail</option>
          <option value="Work Pak Estimate Adjustment">Work Pak Estimate Adjustment</option>
          <option value="Work Pak Estimated Labor">Work Pak Estimated Labor</option>
          <option value="Work Pak Part">Work Pak Part</option>
          <option value="Work Pak Planning">Work Pak Planning</option>
          <option value="Work Pak">Work Pak</option>
        </optgroup>
      </select><br/>

      <input type="checkbox" id="open-doc-box">Open documentation for this data set<br/>

      <label id="name">Choose a file to format</label><br/>
      <input type="file" name="fileToUpload" id="fileToUpload" onchange="dataFileNameSave()">

      <input id="btnGenerate" type="submit" value="Generate" name="submit" onclick="Generate()">

      <div id="example-table"></div>

    </form>
  </div>

  <script type="text/javascript">
  var dataSetName = document.getElementById('dataSetDropDown');
  var dataSetString = dataSetName.options[dataSetName.selectedIndex].value
  var fileLocations = 'ValidationFiles/' + dataSetString + '.pdf';
  var openImpDoc = document.getElementById('open-doc-box');

    //setting the option for the dataset name
    function dataSetNameSave() {
      let dataSetName = document.getElementById('dataSetDropDown');
      let dataSetString = dataSetName.options[dataSetName.selectedIndex].value

      localStorage.setItem("dataSetName", dataSetString);
    };

    //setting the data file name
    function dataFileNameSave() {
      var input = document.getElementById('fileToUpload');
      var fileName = input.files[0].name;
      //var dataFileName = document.getElementById("fileToUpload")

      localStorage.setItem("dataFileName", (fileName));
      //localStorage.setItem("dataFileName", dataFileName);
    };

    function Generate() {

         var dataSetName = document.getElementById('dataSetDropDown');
         var dataSetString = dataSetName.options[dataSetName.selectedIndex].value
         var openImpDoc = document.getElementById('open-doc-box');

         //Open the help documentation for how each data set should be formatted when the check box is checked
      if (dataSetString == 'Select a data set...') {
        alert('Please select a data set from the options below');
        return false;
      } else {
         if (openImpDoc.checked == true) {
            window.open('ValidationFiles/' + dataSetString + '.pdf');
        } else {
            return;
      }
    };
  };

  </script>

</body>
</html>
