
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="description" content="$1">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" type="text/css" href="style.css">
  <link rel="stylesheet" type="text/css" href="form.css">
  <link rel="icon" href="images\corridor-icon.png">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.8.3/jquery.csv.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jexcel/2.0.0/js/jquery.jexcel.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jexcel/2.0.0/css/jquery.jexcel.min.css" type="text/css" />


  <title>CorImport Web Tool</title>

</head>
<body>

  <div class="style">

    <form id="main-form" onsumbit="return formValidate()" action="dataset.html">
      <a id="help" href="https://support.corridor.aero/hc/en-us/restricted?return_to=https%3A%2F%2Fsupport.corridor.aero%2Fhc%2Fen-us">Help</a>
      <a href="https://www.corridor.aero/"><img src="images\CORRIDOR-CAMP-Systems-White-copy.png" alt="CORRIDOR"></a><br/>
      <div id="sub-div">
        <h1>Welcome to the CorImport Web Tool!</h1><br/>
      </div>
      <hr/>
      <label id="name">Data Set</label><br/>
      <select id="dataSetDropDown" onchange="dataSetNameSave()" required>
        <option value="">Select a data set...</option>
        <optgroup label="Accounting">
          <option value="Add Account Numbers">Add Account Numbers</option>
        </optgroup>
        <optgroup label="Aircraft">
          <option value="Add Aircraft">Add Aircraft</option>
        </optgroup>
        <optgroup label="Add/Update Canned Squawk">
          <option value="Canned Squawk Applicability">Canned Squawk Applicability</option>
          <option value="Canned Squawk Estimate Adjustment">Canned Squawk Estimate Adjustment</option>
          <option value="Canned Squawk Estimated Labor">Canned Squawk Estimated Labor</option>
          <option value="Canned Squawk Files">Canned Squawk Files</option>
          <option value="Canned Squawk Part">Canned Squawk Part</option>
          <option value="Canned Squawk Planning">Canned Squawk Planning</option>
          <option value="Canned Squawk">Canned Squawk</option>
        </optgroup>
        <optgroup label="Company Database">
          <option value="Add Company Addresses">Add Company Address</option>
          <option value="Add Company Phone">Add Company Phone</option>
          <option value="Add Company Profile">Add Company Profile</option>
        </optgroup>
        <optgroup label="Contact">
          <option value="Add Contact Address">Add Contact Address</option>
          <option value="Add Contact Phone">Add Contact Phone</option>
          <option value="Add Contact Profile">Add Contact Profile</option>
        </optgroup>
        <optgroup label="Add/Update Inventory">
          <option value="Part Masters">Part Masters</option>
          <option value="Add Inventory Lots">Add Inventory Lots</option>
          <option value="Part Discount Codes">Part Discount Codes</option>
          <option value="Part Pricing">Part Pricing</option>
          <option value="Warehouse Min & Max">Warehouse Min & Max</option>
        </optgroup>
        <optgroup label="Add/Update Tool Crib">
          <option value="Tool Master">Tool Master</option>
          <option value="Tool Master Calibration">Add/Update Tool Master Calibration</option>
          <option value="Tools">Tools</option>
        </optgroup>
        <optgroup label="Add/Update Work Paks">
          <option value="Work Pak Applicability">Work Pak Applicability</option>
          <option value="Work Pak Detail">Work Pak Detail</option>
          <option value="Work Pak Estimate Adjustment">Work Pak Estimate Adjustment</option>
          <option value="Work Pak Estimated Labor">Work Pak Estimated Labor</option>
          <option value="Work Pak Part">Work Pak Part</option>
          <option value="Work Pak Planning">Work Pak Planning</option>
          <option value="Work Pak">Work Pak</option>
        </optgroup>
      </select><br/>

      <input type="checkbox" id="open-doc-box">Open documentation for this data set<br/>

      <label id="name">Choose a file to format</label><br/>
      <input type="file" name="fileToUpload" id="fileToUpload" onchange="dataFileNameSave()" accept=".csv" required/>

      <input id="btnGenerate" type="submit" value="Generate" name="submit" onclick="Generate()"/>

      <div id="example-table"></div>

    </form>
  </div>

  <script type="text/javascript">
  var dataSetName = document.getElementById('dataSetDropDown');
  var dataSetString = dataSetName.options[dataSetName.selectedIndex].value;
  var fileLocations = 'ValidationFiles/' + dataSetString + '.pdf';
  var openImpDoc = document.getElementById('open-doc-box');

    //setting the option for the dataset name
    function dataSetNameSave() {
      let dataSetName = document.getElementById('dataSetDropDown');
      let dataSetString = dataSetName.options[dataSetName.selectedIndex].value;

      localStorage.setItem("dataSetName", dataSetString);
    };

    //setting the data file name
    function dataFileNameSave() {
      var input = document.getElementById('fileToUpload');
      var fileName = input.files[0].name;
      var fileURL = input.value;
      //var dataFileName = document.getElementById("fileToUpload")

      localStorage.setItem("dataFileName", fileName);
      localStorage.setItem("fileURL", fileURL);
      //localStorage.setItem("dataFileName", dataFileName);
    };

    function Generate() {

         var dataSetName = document.getElementById('dataSetDropDown');
         var dataSetString = dataSetName.options[dataSetName.selectedIndex].value;
         var openImpDoc = document.getElementById('open-doc-box');
         var errorMessageName = document.getElementById('error-message-name');
         var errorMessageFile = document.getElementById('error-mrssage-file');

         if (openImpDoc.checked == true) {
            window.open('ValidationFiles/' + dataSetString + '.pdf');
        } else {
            return;
      }
};

    //clear localStorage on refresh
    window.onload = window.localStorage.clear();
    //reset fields on the form
    document.getElementById("main-form").reset();

  </script>

</body>
</html>
