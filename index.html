
<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="description" content="$1">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jexcel/2.0.0/css/jquery.jexcel.min.css" type="text/css"/>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jexcel/2.0.0/css/jquery.jexcel.min.css" type="text/css" />
  <link rel="stylesheet" type="text/css" href="style.css">
  <link rel="stylesheet" type="text/css" href="form.css">
  <link rel="icon" href="images\corridor-icon.png">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.8.3/jquery.csv.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jexcel/2.0.0/js/jquery.jexcel.js"></script>
  <script src="corimport.js"></script>

  <title>CorImport Web Tool</title>

</head>
<body>

  <div class="style">

    <form id="main-form" onsumbit="return formValidate()" action="dataset.html">
      <a id="help" href="https://support.corridor.aero/hc/en-us/restricted?return_to=https%3A%2F%2Fsupport.corridor.aero%2Fhc%2Fen-us">Help</a>
      <a href="https://www.corridor.aero/"><img src="images\CORRIDOR-CAMP-Systems-White-copy.png" alt="CORRIDOR"></a><br/>
      <div id="sub-div">
        <h1>Welcome to the CorImport Web Tool!</h1><br/>
      </div>
      <hr/>
      <label id="name">Data Set</label><br/>
      <select id="dataSetDropDown" onchange="dataSetNameSave()" required>
        <option value="">Select a data set...</option>
        <optgroup label="Accounting">
          <option value="Add Account Numbers">Add Account Numbers</option>
        </optgroup>
        <optgroup label="Aircraft">
          <option value="Add Aircraft">Add Aircraft</option>
        </optgroup>
        <optgroup label="Add/Update Canned Squawk">
          <option value="Canned Squawk Applicability">Canned Squawk Applicability</option>
          <option value="Canned Squawk Estimate Adjustment">Canned Squawk Estimate Adjustment</option>
          <option value="Canned Squawk Estimated Labor">Canned Squawk Estimated Labor</option>
          <option value="Canned Squawk Files">Canned Squawk Files</option>
          <option value="Canned Squawk Part">Canned Squawk Part</option>
          <option value="Canned Squawk Planning">Canned Squawk Planning</option>
          <option value="Canned Squawk">Canned Squawk</option>
        </optgroup>
        <optgroup label="Company Database">
          <option value="Add Company Addresses">Add Company Address</option>
          <option value="Add Company Phone">Add Company Phone</option>
          <option value="Add Company Profile">Add Company Profile</option>
        </optgroup>
        <optgroup label="Contact">
          <option value="Add Contact Address">Add Contact Address</option>
          <option value="Add Contact Phone">Add Contact Phone</option>
          <option value="Add Contact Profile">Add Contact Profile</option>
        </optgroup>
        <optgroup label="Add/Update Inventory">
          <option value="Part Masters">Part Masters</option>
          <option value="Add Inventory Lots">Add Inventory Lots</option>
          <option value="Part Discount Codes">Part Discount Codes</option>
          <option value="Part Pricing">Part Pricing</option>
          <option value="Warehouse Min & Max">Warehouse Min & Max</option>
        </optgroup>
        <optgroup label="Add/Update Tool Crib">
          <option value="Tool Master">Tool Master</option>
          <option value="Tool Master Calibration">Add/Update Tool Master Calibration</option>
          <option value="Tools">Tools</option>
        </optgroup>
        <optgroup label="Add/Update Work Paks">
          <option value="Work Pak Applicability">Work Pak Applicability</option>
          <option value="Work Pak Detail">Work Pak Detail</option>
          <option value="Work Pak Estimate Adjustment">Work Pak Estimate Adjustment</option>
          <option value="Work Pak Estimated Labor">Work Pak Estimated Labor</option>
          <option value="Work Pak Part">Work Pak Part</option>
          <option value="Work Pak Planning">Work Pak Planning</option>
          <option value="Work Pak">Work Pak</option>
        </optgroup>
      </select><br/>

      <input type="checkbox" id="open-doc-box">Open documentation for this data set<br/>
      <label id="name">Choose a file to format</label><br/>
      <input type="file" name="fileToUpload" id="fileToUpload" onchange="dataFileNameSave()" accept=".csv" required/>
      <div class="index-button-container">
        <button type="submit"  class="button-style" id="btnGenerate" name="submit" onclick="Generate()">    Generate</button><br/>
        <button type="button" class="button-style" id="btnErrorSearch"><i class="fas fa-exclamation-triangle"></i>    Have an Error?</button>
    </form>

    <!-- Modal error search window  -->
    <div id="error-modal">
      <div id="error-modal-content">
        <span class="information"><i id="info" class="fas fa-info-circle"></i></span>
        <span id="modal-close" class="close"><i class="far fa-times-circle"></i></span><br/>
        <h2>Search for CorImport Errors</h2>
        <input type="text" id="error-search-box" class="modal-h2" onkeyup="filterErrorList()" placeholder="Search for an error code...">

        <ul id="error-list">
          <li class="error-code"><a href='#'>1030083</a>
            <div class="solution">Column that represents the Min Inventory value is higher than the Max for this row.
              Min needs to be less that the Max to avoid this error.</div>
          </li>
          <li class="error-code"><a href='#'>1000050</a>
            <div class="solution">Date format in the data file does not match the format in CORRIDOR's
              System Configuration. Date format must match exactly. Make sure that any date field on the data set
              includes leading zeros for months that are typically represented my a single number
               (Example: January 6th, 2019 = 01/06/2019, if date format is MM/DD/YYYY).</div>
          </li>
          <li class="error-code"><a href='#'>1031217</a>
            <div class="solution">The serial number on the data file already exists for this part number.
              CORRIDOR will not allow duplicate serial numbers for the same part number</div>
          </li>
          <li class="error-code"><a href='#'>1200011</a>
            <div class="solution">Contact CORRIDOR Support for assistance</div>
          </li>
          <li class="error-code"><a href='#'>1200013</a>
            <div class="solution">Contact CORRIDOR Support for assistance</div>
          </li>
          <li class="error-code"><a href='#'>1200044</a>
            <div class="solution">Contact CORRIDOR Support for assistance</div>
          </li>
          <li class="error-code"><a href='#'>1030035</a>
            <div class="solution">The column on the data file needs to be formatted as plain text.</div>
          </li>
          <li class="error-code"><a href='#'>1990008</a>
            <div class="solution">Generic message that the record failed.
               The error file will likely contin another error for this same record and will help identify why the record did not import.</div>
          </li>
          <li class="error-code"><a href='#'>1990001</a>
            <div class="solution">Nothing to import. This can be caused by the following:
            Importing a lot with a quantity of zero,.</div>
          </li>
          <li class="error-code"><a href='#'>1030080</a>
            <div class="solution">The part number exists, but is marked as inactive.
               Click the "Activate Part Master" button and attempt to import the record again.</div>
          </li>
          <li class="error-code"><a href='#'>2001007</a>
            <div class="solution">Calibration position likely does not exist.
              Only specify a calibration if updating a current position.</div>
          </li>
          <li class="error-code"><a href='#'>1030003</a>
            <div class="solution">This is how you fix</div>
          </li>
          <li class="error-code"><a href='#'>1029019</a>
            <div class="solution">Applicability is required for canned squawks.
              Canned squawks with no applicability defined must be imported as unapproved.
              In the column that represents "Approved", change value to 0.
              These can be approved once applicability is defined.</div>
          </li>
          <li class="error-code"><a href='#'>1000052</a>
            <div class="solution">String of text is too long. CorImport can only import strings of 255 characters or less.
               Reduce string lengths to less than or equal to 255 characters.</div>
          </li>
          <li class="error-code"><a href='#'>1000026</a>
            <div class="solution">Format any columns representing a currency value as Number.
              Omit thousands seperator and currency symbols.</div>
          </li>
          <li class="error-code"><a href='#'>1030035</a>
            <div class="solution">Part master may exist for the lot that is trying to import, but part number is in all uppercase and the part master on the data file must also reflect all uppercase to load correctly.
              Edit the part number field on the data file to capitalize all alphabetical characters.</div>
          </li>
          <li class="error-code"><a href='#'>1031208</a>
            <div class="solution">Serial Number cannot validate because part number doesn't exist or is in the incorrect format.
              If part number does exist in CORRIDOR, edit the part number field on the data file to capitalize all alphabetical characters.</div>
          </li>
          <li class="error-code"><a href='#'>1200001</a>
            <div class="solution">Database Error. Please contact CORRIDOR Support for assistance.</div>
          </li>
          <li class="error-code"><a href='#'>1200002</a>
            <div class="solution">The Operating Condition does not already exist in Corridor. Please create the Operating Condition (Maintain > Aircraft > Operating Conditions...) and attempt to import the file again.</div>
          </li>
          <li class="error-code"><a href='#'>1200003</a>
            <div class="solution">The Status does not already exist in Corridor. Please create the Status (Maintain > Aircraft > Statuses...) and attempt to import the file again.</div>
          </li>
          <li class="error-code"><a href='#'>1200004</a>
            <div class="solution">The Airport does not already exist in Corridor and cannot be imported to the "Home Airport" field. Please create the Airport (Maintain > Company Database > Airports...) and attempt to import the file again.</div>
          </li>
          <li class="error-code"><a href='#'>1200005</a>
            <div class="solution">The Company designated as the Purchasor does not already exist in Corridor and cannot be imported to the "Purchased from" field. Please create the Company in the Company Database module and attempt to import the file again.</div>
          </li>
          <li class="error-code"><a href='#'>1200006</a>
            <div class="solution">The Company designated as the Owner does not already exist in Corridor and cannot be imported to the "Owned by" field. Please create the Company in the Company Database module and attempt to import the file again.</div>
          </li>
          <li class="error-code"><a href='#'>1200007</a>
            <div class="solution">The Company designated as the Leasor does not already exist in Corridor and cannot be imported to the "Leased by" field. Please create the Company in the Company Database module and attempt to import the file again.</div>
          </li>
          <li class="error-code"><a href='#'>1200008</a>
            <div class="solution">The Company designated as the Manager does not already exist in Corridor and cannot be imported to the "Managed by" field. Please create the Company in the Company Database module and attempt to import the file again.</div>
          </li>
          <li class="error-code"><a href='#'>1200009</a>
            <div class="solution">The Company designated as the Operator does not already exist in Corridor and cannot be imported to the "Operated by" field. Please create the Company in the Company Database module and attempt to import the file again.</div>
          </li>
          <li class="error-code"><a href='#'>1200010</a>
            <div class="solution">The Company does not already exist in Corridor and must exist in Corridor prior to attempting an import. Please create the Company in the Company Database module and attempt to import the file again.</div>
          </li>
          <li class="error-code"><a href='#'>1200011</a>
            <div class="solution">The specific model of Aircraft has not been assigned to the corresponding Manufacturer. Assign this model to the manufacturer (Maintain > System > Aircraft > Models) by searching for the specific model and re-selecting the Manufacturer, or create a new Model if it does not yet exist.</div>
          </li>
          <li class="error-code"><a href='#'>1200012</a>
            <div class="solution">The Registration number field is required for this import. Please speficy a Registration number for each record on the spreadsheett and attempt the import again.</div>
          </li>
          <li class="error-code"><a href='#'>1200013</a>
            <div class="solution"></div>
          </li>
          <li class="error-code"><a href='#'>1200014</a>
            <div class="solution">The Manufacturer Code is a required field for this import. Please specify the company code for a Company that currently exists in the Company Database module and is designated as an Aircraft Manufacturer.</div>
          </li>
          <li class="error-code"><a href='#'>1200015</a>
            <div class="solution">The Aircraft is already associated to an Compliance Configuration and cannot be inactivated. Please remove the Tracking ID item in Corridor to disassociate from the configuration and attempt the import again.</div>
          </li>
          <li class="error-code"><a href='#'>1200016</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200018</a>
            <div class="solution">The Serial Number Core is a required field for this import. Please speficy the core part of each serial number for each record on the spreadsheet and attempt the import again.</div>
          </li>
          <li class="error-code"><a href='#'>1200019</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200020</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200021</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200022</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200023</a>
            <div class="solution">The Base of Operations specified on the file does not yet exist. The drop down list for this field is populated from the list addresses that are currently set up for the company that is assigned in the "Owned by" field. Please create the address for the company in the Company Database module and attempt to import the file again</div>
          </li>
          <li class="error-code"><a href='#'>1200024</a>
            <div class="solution">The Aircraft model field is a required field for this import. Please specify an aircraft model that this Registration number should be associated to andattempt the import again.</div>
          </li>
          <li class="error-code"><a href='#'>1200025</a>
            <div class="solution">The file is attempting to import a Base of Operations, but there is no Owned by company listed for the record. Please make sure that an Owned by company is listed for each record, and that the Base of operations has been added as a company address in the Company Database module for the company that is being designated as the owner.</div>
          </li>
          <li class="error-code"><a href='#'>1200026</a>
            <div class="solution">The Warranty Program that has been selected to import is not valid or has not been created. Please create this Warranty Program in Maintain > Warranty > Warranty Programs... and attempt the import again.</div>
          </li>
          <li class="error-code"><a href='#'>1200027</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200028</a>
            <div class="solution">The serial number is already assigned to another aircraft and cannot be used again. Please review and correct the serial number for this record and attempt the import again.</div>
          </li>
          <li class="error-code"><a href='#'>1200029</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200030</a>
            <div class="solution">The company selected to be imported to the Owned by field does not exist or has been inactivated in Corridor. Please create this company or reacivate the company in the Comapny database module and attempt the import again.</div>
          </li>
          <li class="error-code"><a href='#'>1200031</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200032</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200033</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200034</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200035</a>
            <div class="solution">The Status on the file does not exist in Corridor. Please navigate to Maintain > Aircraft > Statuses... to create this status and attempt the import again.> </div>
          </li>
          <li class="error-code"><a href='#'>1200036</a>
            <div class="solution">The Status on the file does not exist in Corridor. Please navigate to Maintain > Aircraft > Statuses... to create this status and attempt the import again.</div>
          </li>
          <li class="error-code"><a href='#'>1200037</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200038</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200039</a>
            <div class="solution">Serial Number cannot validate because part number doesn't exist or is in the incorrect format.
              If part number does exist in CORRIDOR, edit the part number field on the data file to capitalize all alphabetical characters.</div>
          </li>
          <li class="error-code"><a href='#'>1200040</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200041</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200042</a>
            <div class="solution">The company selected to be imported to the Owned by field does not exist or has been inactivated in Corridor. Please create this company or reacivate the company in the Comapny database module and attempt the import again.</div>
          </li>
          <li class="error-code"><a href='#'>1200044</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200045</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200048</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200049</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200050</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200051</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200052</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200053</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200054</a>
            <div class="solution">Serial Number cannot validate because part number doesn't exist or is in the incorrect format.
              If part number does exist in CORRIDOR, edit the part number field on the data file to capitalize all alphabetical characters.</div>
          </li>
          <li class="error-code"><a href='#'>1200055</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200056</a>
            <div class="solution">Serial Number cannot validate because part number doesn't exist or is in the incorrect format.
              If part number does exist in CORRIDOR, edit the part number field on the data file to capitalize all alphabetical characters.</div>
          </li>
          <li class="error-code"><a href='#'>1200057</a>
            <div class="solution">Serial Number cannot validate because part number doesn't exist or is in the incorrect format.
              If part number does exist in CORRIDOR, edit the part number field on the data file to capitalize all alphabetical characters.</div>
          </li>
          <li class="error-code"><a href='#'>1200058</a>
            <div class="solution">The Fuel Lot that was selected to be imported the Default fuel lot field is not valid or has not been created. For a Fuel lot to be considered valid, it must have been created in Maintain > Line Sales > Fuel Lots.... Please create the Fuel Lot and attempt the import again.</div>
          </li>
          <li class="error-code"><a href='#'>1200059</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200060</a>
            <div class="solution">////////////////////</div>
          </li>
          <li class="error-code"><a href='#'>1200061</a>
            <div class="solution">The Posting Profile selected to be imported for this record is not applicable to Work Orders. Please navigate to Maintain > Accounting > Posting Profiles... and change the Molule applicability, or create a new Posting profile that applies to Work Orders.</div>
          </li>
          <li class="error-code"><a href='#'>1200062</a>
            <div class="solution">The Posting Profile selected to be imported for this record is not applicable to Folios. Please navigate to Maintain > Accounting > Posting Profiles... and change the Molule applicability, or create a new Posting profile that applies to Folios (Sales Invoice).</div>
          </li>
          <li class="error-code"><a href='#'>1200063</a>
            <div class="solution">////////////////////</div>
          </li>
        </ul>
    </div>
  </div>

  <script type="text/javascript">
    var dataSetName = document.getElementById('dataSetDropDown');
    var dataSetString = dataSetName.options[dataSetName.selectedIndex].value;
    var fileLocations = 'ValidationFiles/' + dataSetString + '.pdf';
    var openImpDoc = document.getElementById('open-doc-box');
    var errorModal = document.getElementById('error-modal');
    var btnErrorSearch = document.getElementById('btnErrorSearch');
    var span = document.getElementsByClassName("close")[0];

    //setting the option for the dataset name
    function dataSetNameSave() {
      var dataSetName = document.getElementById('dataSetDropDown');
      var dataSetString = dataSetName.options[dataSetName.selectedIndex].value;

      localStorage.setItem("dataSetName", dataSetString);
    }

    //setting the data file name
    function dataFileNameSave() {
      var input = document.getElementById('fileToUpload');
      var fileName = input.files[0].name;
      var fileURL = input.value;
      //var dataFileName = document.getElementById("fileToUpload")

      localStorage.setItem("dataFileName", fileName);
      localStorage.setItem("fileURL", fileURL);
      console.log(input.value);
      //localStorage.setItem("dataFileName", dataFileName);
    }

    //open document if the check box is marked
    function Generate() {
         var dataSetName = document.getElementById('dataSetDropDown');
         var dataSetString = dataSetName.options[dataSetName.selectedIndex].value;
         var openImpDoc = document.getElementById('open-doc-box');
         var errorMessageName = document.getElementById('error-message-name');
         var errorMessageFile = document.getElementById('error-mrssage-file');

         if (openImpDoc.checked == true) {
            window.open('ValidationFiles/' + dataSetString + '.pdf');
        } else {
            return;
      }
    }

    // When the user clicks the button, open the modal
      $("#btnErrorSearch").click(function() {
        $("#error-modal").fadeIn('fast');
      });
    // When the user clicks on <span> (x), close the modal
      $("#modal-close").click(function() {
        $("#error-modal").fadeOut('fast');
      });
    // When the user clicks anywhere outside of the modal, close it
      $(window).click(function(event) {
        if (event.target == errorModal) {
          $("#error-modal").fadeOut('fast');
        }
      });
    // When user clicks the info icon, display alert to display the purpose of the window
        $("#info").click(function() {
          alert("This search window provides a list of errors and corresponding solutions to correct the failed CorImport. Search for the error code that caused the CorImport to fail, and click on the error for more details on how it can be corrected. Please contact CORRIDOR Support for additional information.");
        });

        //Display 0 error codes if user has not started searching
        if (document.getElementById("error-search-box") == "") {
          document.getElementById("error-list").style.display = "none";
        } else {
          document.getElementById("error-list").style.display = "block";
        }

        //Generate button disabled if data set and file not populated
        // if (dataSetName.value == null || document.getElementById('fileToUpload').value == null) {
        //   document.getElementById('btnGenerate').disable = true;
        // } else {
        //   document.getElementById('btnGenerate').disable = false;
        // }

    //Error Search Modal: Fiter error search list based on text entered in the search checkbox
    function filterErrorList() {
     var input, filter, ul, li, a, i, txtValue;

     input = document.getElementById("error-search-box");
     filter = input.value.toUpperCase();
     ul = document.getElementById("error-list");
     li = ul.getElementsByTagName("li");

     for (i = 0; i < li.length; i++) {
         a = li[i].getElementsByTagName("a")[0];
         txtValue = a.textContent || a.innerText;
         if (txtValue.toUpperCase().indexOf(filter) > -1) {
             li[i].style.display = "";
           } else {
             li[i].style.display = "none";
           }
         }
       }

       //Accordion when an error is clicked
       $(document).ready(function(){
      $('.error-code').click(function(e){
        e.preventDefault();
        $(this).closest('li').find('.solution').slideToggle();
      });
    });

    //clear localStorage on refresh
    window.onload = window.localStorage.clear();
    //reset fields on the form
    document.getElementById("main-form").reset();
  </script>

  </body>
</html>
