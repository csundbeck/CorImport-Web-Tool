<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="description" content="$1">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" type="text/css" href="css/form.css">
    <link rel="stylesheet" type="text/css" href="font-awesome-4.7.0\css\font-awesome.min.css">
    <link rel="icon" href="images\corridor-icon.png">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <link rel="stylesheet" href="css/jexcel_v3.css" type="text/css"/>
    <link rel="stylesheet" href="css/japp_v3.css" type="text/css"/>
    <link rel="stylesheet" href="css/jexcel.datatables.css" type="text/css"/>
    <link rel="stylesheet" type="text/css" href="css/material-icons.css"/>

    <script src="js/jexcel_v3.js"></script>
    <script src="js/japp_v3.js"></script>
    <script src="js/jquery.min.js"></script>
    <script src="js/jquery.csv.min.js"></script>

    <script src="js/corimport.js" type="text/javascript"></script>

    <title>CorImport Web Tool</title>

  </head>
  <body>

  <div class="style">
    <form>
      <div class="menu-container" onclick="openHelpMenu(this)">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
          <div id="help-menu-contents" class="dropdown-content">
            <a href="https://support.corridor.aero/hc/en-us/sections/115000828514-CorImport">CorImport How-To</a>
            <a href="https://support.corridor.aero/hc/en-us/categories/115001230327-FAQ">Corridor FAQ</a>
            <!-- <a href="#">Launch corimport.exe</a> -->
          </div>
      </div>
      <a href="https://www.corridor.aero/"><img src="images\CORRIDOR-CAMP-Systems-White-copy.png" alt="CORRIDOR"></a><br/>
      <div id="sub-div">
        <div id="header-container">
          <h1 id="data-set-name"></h1><br/>
          <p id="data-file-name"></p><br/>
          <hr id="dataset-hr"/><br/>
        </div>
        <div></div>
        <div id="spreadsheet"></div><br/>
        <div class="button-container">
          <button type="button" id="btnSendToSupport" class="button-style"><i class="fas fa-envelope"></i>  Send to CORRIDOR Support</button><br/>
          <button type="button" id="btnRestart" class="button-style"><i class="fa fa-repeat" aria-hidden="true"></i>    Restart</button>
        </div>
      </div>
    </form>
  </div>

  <div id="email-modal">
    <div id="email-modal-content">
      <span class="information"><i id="email-info" class="fas fa-info-circle"></i></span>
      <span id="modal-close" class="close"><i class="far fa-times-circle"></i></span><br/>
      <h2>Send File to Corridor Support</h2>
      <p>Subject: <input type="text" id="email-subject" class="modal-h2"></p>
      <textarea id="msg-body" rows="10" placeholder="Include a message..."></textarea><br>
      <p>Attach the data file: </br><input type="file" id="email-data-file" name="fileToUpload" accept=".csv" required/></p>
      <p>Attach the error log: </br><input type="file" name="fileToUpload" accept=".txt" required/></p>
      </hr>
      <div class="email-button-container">
        <button id="btnEmailSupport" class="button-style"><i class="fas fa-paper-plane"></i>   Send</button>
      </div>
    </div>
  </div>

<script type="text/javascript">
var dataSetName = document.getElementById('data-set-name');
var dataFileName = document.getElementById('data-file-name');
var data = localStorage.getItem("dataFileName");
var btnSendToSupport = document.getElementById("btnSendToSupport");
var emailModal = document.getElementById('email-modal');
var dataSetNameText = localStorage.getItem('dataSetName');
var dateFormat = localStorage.getItem('ss-DateFormat');
var decimalSep = localStorage.getItem('ss-DecimalSepFormat');
var td = document.getElementsByTagName("td");
const API_KEY = '16c173aa5ef987d8de12203e4ee12435-afab6073-d03eb4e0';

//Display help menu
function openHelpMenu(x) {
  var helpMenuContents = document.getElementById("help-menu-contents");

  if (helpMenuContents.style.display !== "block") {
    helpMenuContents.style.display = "block";
  } else {
    helpMenuContents.style.display = "none";
  }
  x.classList.toggle("change");
}

if (localStorage.getItem('dataSetName') == null) {
  dataSetName.innerHTML = "CorImport Web Tool";
  btnSendToSupport.style.display = 'none';
  alert('Please return the the home page and select a Data Set and a Data File to format.');
} else {
  dataSetName.innerHTML = localStorage.getItem('dataSetName') + " Import";
  btnSendToSupport.style.display = 'block';
}

if (data == null) {
  dataFileName.innerHTML = "**No file has been selected**";
  dataFileName.style.color = '#FFFF66';
} else {
  var trimFileName = localStorage.getItem('fileURL').slice(12);
  dataFileName.innerHTML = "The name of this file is " + trimFileName;
}

//'DD-Mon-YYYY' and 'YYYY/MM/DD' currently not working, so setting fields to text type if those date formats are selected
var calendarType;
if (dateFormat !== "DD-Mon-YYYY" || dateFormat !== "YYYY/MM/DD") {
  calendarType = 'calendar';
  dateFormat;
} else {
    calendarType = 'text';
}

//Setting the numeric field masks
var numMask;
if (decimalSep == '.') {
  numMask = '#0.0#';
} else {
  numMask = '#0,0#';
}

var customCol = {
  openEditor: function(cell) {
    var element = doument.getElementsByTagName('input');
    element.innerText.toUpperCase()
  }
}

//Spreadsheet entry
switch(dataSetNameText) {
  case 'Add Account Numbers':
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  selectionCopy: 1,
  columns: [
            { type: 'text' },
            { type: 'dropdown', source:[{id:1,name:'Accounts payable'},
                                        {id:2,name:'Accounts receivable'},
                                        {id:3,name:'Cash'},
                                        {id:4,name:'Cost of sales'},
                                        {id:5,name:'Current liabilities'},
                                        {id:6,name:'Expenses'},
                                        {id:7,name:'Inventory'},
                                        {id:8,name:'Purchases'},
                                        {id:9,name:'Sales revenue'},
                                        {id:10,name:'Work in process'}
                                      ], autocomplete:true, placeholder: 'blah'},
            { type: 'text' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells yellow if they are missing data
        updateTable: function(instance, cell, col, row, val, label, cellName) {
          var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
          var cellValues = document.querySelectorAll('table.jexcel > tbody > tr > td > input').innerText;
          var numCols = headerLabels.length;

             //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
              if (cell.innerHTML == "") {
                   cell.style.backgroundColor = '#FFFF99';
               } else {
                   cell.style.backgroundColor = '#FFFFFF';
               }

             for (let i = 0; i < numCols; i++) {
                 if (headerLabels[i].innerText == "Account Number" || headerLabels[i].innerHTML == "Account Category" || headerLabels[i].innerHTML == "Account Description") {
                   headerLabels[i].style.backgroundColor = '#FFFF00';
              }
          }

            for (let j = 0; j < numCols; j++) {
              if (headerLabels[j].innerText == "Part Number") {
                for (let h = 0; h < cell.length; h++) {
                  cellValues.style.textTransform = "uppercase";
              }
            }
          }
        }
      });
  break;
  case 'Add Aircraft':
  //Aircrafts
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  loadingSpin:true,
  lazyLoading: true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

            for (let i = 0; i < numCols; i++) {
                if (headerLabels[i].innerHTML == "Registration Number" || headerLabels[i].innerHTML == "Aircraft Manufacturer Code" || headerLabels[i].innerHTML == "Aircraft Model" || headerLabels[i].innerHTML == "Serial Number Core") {
                  headerLabels[i].style.backgroundColor = '#FFFF00';
               }
             }
        }
  });
  break;
  case 'Canned Squawk Applicability':
  //CSqwk Applicability
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'numeric', mask: '#'},
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Canned Squawk Name" || headerLabels[i].innerHTML == "Sequence Number") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }
        }
  });
  break;
  case 'Canned Squawk Estimate Adjustment':
  //CSqwk Est Adj
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'numeric', mask: '#' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'dropdown', source: [{id:0, name:'0'},
                                         {id:1, name:'1'},
                                       ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                                          {id:1, name:'1'},
                                        ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                                           {id:1, name:'1'},
                                         ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                                        {id:1, name:'1'},
                                      ], autocomplete:true },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            let headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            let numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Canned Squawk Name" || headerLabels[i].innerHTML == "Sequence Number" || headerLabels[i].innerHTML == "Description") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }
        }
  });
  break;
  case 'Canned Squawk Estimated Labor':
  //CSqwk Est Labor
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'numeric', mask: '#'},
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                                         {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                                         {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                                         {id:1, name:'1'},
                           ], autocomplete:true },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Canned Squawk Name" || headerLabels[i].innerHTML == "Sequence Number" || headerLabels[i].innerHTML == "Department" || headerLabels[i].innerHTML == "Revenue Hours" || headerLabels[i].innerHTML == "Cost Hours" || headerLabels[i].innerHTML == "Estimated Labor Revenue") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }
        }
  });
  break;
  case 'Canned Squawk Files':
  //CSqwk Files
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'numeric', mask: '#'},
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Canned Squawk Name" || headerLabels[i].innerHTML == "Sequence Number" || headerLabels[i].innerHTML == "File Name") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }
        }
  });
  break;
  case 'Canned Squawk Part':
  //CSqwk Parts
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'numeric', mask: '#'},
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'dropdown', source: [{id:0, name:'0'},
                                         {id:1, name:'1'},
                           ], autocomplete:true },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Canned Squawk Name" || headerLabels[i].innerHTML == "Sequence Number" || headerLabels[i].innerHTML == "Part Number" || headerLabels[i].innerHTML == "Part Description" || headerLabels[i].innerHTML == "Demand Quantity") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }
        }
  });
  break;
  case 'Canned Squawk Planning':
  //CSqwk Planning
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'numeric', mask: '#'},
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Canned Squawk Name" || headerLabels[i].innerHTML == "Sequence Number") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }
        }
  });
  break;
  case 'Canned Squawk':
  //CSqwk
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'dropdown', source:[{id:1, name: 'Time and Materials'},
                                        {id:2, name: 'Flat Rate'},
                                        {id:3, name: 'No Charge'},
                                      ], autocomplete: true},
            { type: 'dropdown', source:[{id:1,name:'Time and Materials'},
                                        {id:2,name:'Flat Rate'},
                                        {id:3,name:'No Charge'}
                                      ], autocomplete:true},
            { type: 'dropdown', source:[{id:1,name:'Time and Materials'},
                                        {id:2,name:'Flat Rate'},
                                        {id:3,name:'No Charge'},
                                       ], autocomplete:true},
            { type: 'dropdown', source:[{id:1,name:'Time and Materials'},
                                        {id:2,name:'Flat Rate'},
                                        {id:3,name:'No Charge'},
                                       ], autocomplete:true},
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'text' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Canned Squawk Name" || headerLabels[i].innerHTML == "Description" || headerLabels[i].innerHTML == "Squawk Part Activity") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }
        }
  });
  break;
  case 'Add Company Addresses':
  //Company Address
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Account Code" || headerLabels[i].innerHTML == "Title") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }
        }
  });
  break;
  case 'Add Company Phone':
  //Company Phone
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'text' },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Account Code" || headerLabels[i].innerHTML == "Title") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }
        }
  });
  break;
  case 'Add Company Profile':
  //Company Profile
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'text' },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'text' },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            { type: 'text' },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'text' },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'text' },
            { type: 'text' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Account Code" || headerLabels[i].innerHTML == "Company Name") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }
        }
  });
  break;
  case 'Add Contact Address':
  //Contact Addresses
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Contact Name" || headerLabels[i].innerHTML == "Title") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }
        }
  });
  break;
  case 'Add Contact Phone':
  //Contact Phones
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Contact Name" || headerLabels[i].innerHTML == "Title" || headerLabels[i].innerHTML == "Address Title") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
             }
          }
  });
  break;
  case 'Add Contact Profile':
  //Contact Profiles
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'dropdown', source:[{id:1,name:'Male'},
                                        {id:2,name:'Female'}
                                      ], autocomplete:true},
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            { type: 'dropdown', source:[{id:1,name:'Divorced'},
                                        {id:2,name:'Married'},
                                        {id:3,name:'Single'},
                                        {id:3,name:'Widowed'}
                                      ], autocomplete:true},
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            { type: 'text' },
            { type: 'text' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Contact Name") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }

        }
  });
  break;
  case 'Part Masters':
  //Part Masters
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Part Number" || headerLabels[i].innerHTML == "Description") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }
        }
  });
  break;
  case 'Add Inventory Lots':
  //Inventory Lots
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            { type: 'text' },
            { type: 'text' },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Part Number" || headerLabels[i].innerHTML == "Part Condition" || headerLabels[i].innerHTML == "Part Status" || headerLabels[i].innerHTML == "Part Quantity" || headerLabels[i].innerHTML == "Owner Code" || headerLabels[i].innerHTML == "Warehouse" || headerLabels[i].innerHTML == "Cost"
                   || headerLabels[i].innerHTML == "Serial Number") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }

        }
  });
  break;
  case 'Part Discount Codes':
  //Part Discount Codes
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Part Number" || headerLabels[i].innerHTML == "Part Condition" || headerLabels[i].innerHTML == "Discount Code") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }

        }
  });
  break;
  case 'Part Pricing':
  //Part Pricing
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Part Number" || headerLabels[i].innerHTML == "Part Condition") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }

        }
  });
  break;
  case 'Warehouse Min & Max':
  //Warehouse Min/Max
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'numeric', mask: numMask, decimal: decimalSep },
            { type: 'numeric', mask: numMask, decimal: decimalSep },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Part Number" || headerLabels[i].innerHTML == "Warehouse Minimum" || headerLabels[i].innerHTML == "Warehouse Maximum") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }

        }
  });
  break;
  case 'Tool Master':
  //Tool Master
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'text' },
          ],
          toolbar:[
            { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
            { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
            { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
            { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
            { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
            // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
            ],
          //Make cells red if they are missing data
          updateTable:function(instance, cell, col, row, val, label, cellName) {
              //Checks cells that are empty (sends warning with red text)
              var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
              var numCols = headerLabels.length;

              //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
               if (cell.innerHTML == "") {
                    cell.style.backgroundColor = '#FFFF99';
                } else {
                    cell.style.backgroundColor = '#FFFFFF';
                }

                for (let i = 0; i < numCols; i++) {
                     if (headerLabels[i].innerHTML == "Tool Number" || headerLabels[i].innerHTML == "Description") {
                      headerLabels[i].style.backgroundColor = '#FFFF00';
                  }
              }

          }
  });
  break;
  case 'Tool Master Calibration':
  //Tool Master Cal
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'numeric', mask: '#'},
            { type: 'text' },
            { type: 'numeric', mask: numMask, decimal: decimalSep },
            { type: 'text' },
          ],
          toolbar:[
            { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
            { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
            { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
            { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
            { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
            // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
            ],
          //Make cells red if they are missing data
          updateTable:function(instance, cell, col, row, val, label, cellName) {
              //Checks cells that are empty (sends warning with red text)
              var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
              var numCols = headerLabels.length;

              //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
               if (cell.innerHTML == "") {
                    cell.style.backgroundColor = '#FFFF99';
                } else {
                    cell.style.backgroundColor = '#FFFFFF';
                }

                for (let i = 0; i < numCols; i++) {
                     if (headerLabels[i].innerHTML == "Tool Number" || headerLabels[i].innerHTML == "Position" || headerLabels[i].innerHTML == "Frequency") {
                      headerLabels[i].style.backgroundColor = '#FFFF00';
                  }
              }

          }
  });
  break;
  case 'Tools':
  //Tool IDs
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
            { type: 'text' },
            { type: 'text' },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: calendarType,
               options: { format: dateFormat, today: 1, placeholder: dateFormat }
            },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Tool ID" || headerLabels[i].innerHTML == "Tool Number" || headerLabels[i].innerHTML == "Tool Room") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }

        }
  });
  break;
  case 'Work Pak Applicability':
  //Work Pak Applicability
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'numeric', mask: '#'},
            { type: 'text' },
            { type: 'text' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Work Pak Name" || headerLabels[i].innerHTML == "Applicability Sequence Number") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }

        }
  });
  break;
  case 'Work Pak Detail':
  //Work Pak Detail
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'numeric', mask: '#'},
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'text' },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Work Pak Name" || headerLabels[i].innerHTML == "Step Sequence Number" || headerLabels[i].innerHTML == "Description") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }

        }
  });
  break;
  case 'Work Pak Estimate Adjustment':
  //Work Pak Est Adj
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'numeric', mask: '#'},
            { type: 'numeric', mask: '#'},
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Work Pak Name" || headerLabels[i].innerHTML == "Work Pak Step Sequence Number" || headerLabels[i].innerHTML == "Adjustment Sequence Number" || headerLabels[i].innerHTML == "Description") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }

        }
  });
  break;
  case 'Work Pak Estimated Labor':
  //Work Pak Est Labor
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'numeric', mask: '#'},
            { type: 'numeric', mask: '#'},
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Work Pak Name" || headerLabels[i].innerHTML == "Work Pak Step Sequence Number" || headerLabels[i].innerHTML == "Estimated Labor Sequence Number" || headerLabels[i].innerHTML == "Department" || headerLabels[i].innerHTML == "Revenue Hours" || headerLabels[i].innerHTML == "Cost hours") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }

        }
  });
  break;
  case 'Work Pak Part':
  //Work Pak Parts
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'numeric', mask: '#'},
            { type: 'numeric', mask: '#'},
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Work Pak Name" || headerLabels[i].innerHTML == "Work Pak Step Sequence Number" || headerLabels[i].innerHTML == "Part Sequence Number" || headerLabels[i].innerHTML == "Part Number" || headerLabels[i].innerHTML == "PartDescription" || headerLabels[i].innerHTML == "Demand Quantity") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }

        }
  });
  break;
  case 'Work Pak Planning':
  //Work Pak Planning
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'numeric', mask: '#'},
            { type: 'numeric', mask: '#'},
            { type: 'text' },
            { type: 'text' },
            {type: 'numeric', mask: numMask, decimal: decimalSep},
            {type: 'numeric', mask: numMask, decimal: decimalSep},
        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Work Pak Name" || headerLabels[i].innerHTML == "Work Pak Step Sequence Number" || headerLabels[i].innerHTML == "Planning Sequence Number") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }

        }
  });
  break;
  case 'Work Pak':
  //Work Paks
  var spreadsheet = jexcel(document.getElementById('spreadsheet'), {
  // file path of the CSV file
  csv: localStorage.getItem("fullFilePath"),
  csvHeaders: true,
  search:true,
  tableHeight: '462px',
  tableOverflow:true,
  lazyLoading: true,
  loadingSpin:true,
  defaultColWidth: 150,
  rowDrag: 1,
  rowResize: 1,
  columnSorting: 1,
  columnDrag: 1,
  columnResize: 1,
  minSpareCols: 0,
  columns: [
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'text' },
            { type: 'dropdown', source: [{id:0, name:'0'},
                             {id:1, name:'1'},
                           ], autocomplete:true },
            { type: 'text' },

        ],
        toolbar:[
          { type:'i', content:'undo', onclick:function() { spreadsheet.undo(); } },
          { type:'i', content:'redo', onclick:function() { spreadsheet.redo(); } },
          { type:'i', content:'get_app', onclick:function () { spreadsheet.download(); } },
          { type:'i', content: 'add' + 'COL', onclick:function () { spreadsheet.insertColumn(1, spreadsheet.getHeaders().split(",").length - 1, 0, {type: 'text', title: 'UDF'}); } },
          { type:'i', content: 'add' + 'ROW', onclick:function () { spreadsheet.insertRow(1) } },
          // { type:'i', content:'#NULL', onclick:function (instance, cell, col, row, val, label, cellName) {if (td.innerText == "") {td.innerText = '#NULL';} } },
          ],
        //Make cells red if they are missing data
        updateTable:function(instance, cell, col, row, val, label, cellName) {
            //Checks cells that are empty (sends warning with red text)
            var headerLabels = document.querySelectorAll('table.jexcel > thead > tr > td');
            var numCols = headerLabels.length;

            //Changing the Columns and Cell colors based on require ment and missing data (Boolean cells will stay '#FFFFFF' regardless)
             if (cell.innerHTML == "") {
                  cell.style.backgroundColor = '#FFFF99';
              } else {
                  cell.style.backgroundColor = '#FFFFFF';
              }

              for (let i = 0; i < numCols; i++) {
                   if (headerLabels[i].innerHTML == "Work Pak Name" || headerLabels[i].innerHTML == "Description") {
                    headerLabels[i].style.backgroundColor = '#FFFF00';
                }
            }

        }
  });
  break;
}

//Handling error files
function openFile(event) {
  var input = event.target;
  var errorFileReader = new FileReader();

  errorFileReader.onload = function() {
  var dataURL = errorFileReader.result;
  var output = localStorage.setItem("errorFilePath", dataURL);
};
errorFileReader.readAsDataURL(input.files[0]);

};

//Return to index.html
 $('#btnRestart').on('click', function () {
   location.href = 'index.html';
 });

// When the user clicks the button, open the email modal and populate the subject line
 $("#btnSendToSupport").click(function() {
   $("#spreadsheet").css("display", "none");
   $("#btnSendToSupport").css("display", "none");
   $("#btnRestart").css("display", "none");
   $("#email-modal").fadeIn('fast');
   $("#email-subject").val(localStorage.getItem('dataSetName') + ' CorImport Issue');
 });

 $("#email-info").click(function() {
   alert("This window will allow you to send the data file for review to Corridor Support. Please include your name, aswell as the name of the Company that you are loading the data for in the message of this email.");
 });

 //Send email
 $('#btnEmailSupport').click(function() {
   const mailgun = require("mailgun-js");
   const DOMAIN = 'sandbox591759ceacd845eaa68b9b548e006d20.mailgun.org';
   const mg = mailgun({apiKey: API_KEY, domain: DOMAIN});
   var data = {
   	from: 'Excited User <me@samples.mailgun.org>',
   	to: 'support@corridor.aero, YOU@YOUR_DOMAIN_NAME',
   	subject: document.getElementById("").value,
   	text: document.getElementById("msg-body").value,
   };
   mg.messages().send(data, function (error, body) {
   	// console.log(body);
   });

   $("#email-modal").fadeOut('fast');
   $("#spreadsheet").css("display", "block");
   $("#btnSendToSupport").css("display", "block");
   $("#btnRestart").css("display", "block");
 });

 $("#modal-close").click(function() {
   $("#email-modal").fadeOut('fast');
   $("#spreadsheet").css("display", "block");
   $("#btnSendToSupport").css("display", "block");
   $("#btnRestart").css("display", "block");
 });

// When the user clicks anywhere outside of the modal, close it
 $(window).click(function(event) {
   if (event.target == emailModal) {
     $("#email-modal").fadeOut('fast');
     $("#spreadsheet").css("display", "block");
     $("#btnSendToSupport").css("display", "block");
     $("#btnRestart").css("display", "block");
   }
 });
 </script>
  </body>
</html>
